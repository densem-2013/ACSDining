@{
    ViewBag.Title = "Index";
}

    <div class="panel panel-default" id="mfwPanel" >
       
        <table class="table table-striped table-bordered table-responsive table-condensed table-hover" id="updateTable" style="font-size: 1.2em; text-align: center">
            <thead>
                <tr style="vertical-align: middle;">
                    <!-- ko with: WorkingWeek-->
                    <td  style="white-space: nowrap"><span>Рабочие дни : </span></td>
                    <!--ko foreach: WorkingDays-->
                    <td>
                        <div style="vertical-align: middle; white-space: nowrap">
                            <!-- ko text: DayNumber--><!-- /ko-->
                            <input type="checkbox"  data-bind="checked: IsWorking, value: IsWorking" />
                            <span data-bind="text: DayName"></span>
                        </div>
                    </td>
                    <!-- /ko-->
                    <td>
                        <div style="vertical-align: middle; width: 100%">
                            <input type="button" value="Подтвердить рабочие дни" class="btn btn-info" data-bind=" click: $root.WorkWeekApply , visible: CanBeChanged" />
                        </div>
                    </td>
                    <!-- /ko-->
                </tr>
                <tr style="background: #565659;">
                    <td colspan="2" style="border-right-style: none;">
                        <div style="vertical-align: middle; width: 100%">
                            <input type="button" value="Перейти на текущую неделю" class="btn btnaddmenu" data-bind=" click: function(){$root.SetMyDateByWeek($root.CurrentWeekYear())}, visible: !IsCurrentWeekYear(), css:{'btn-danger': IsCurrentWeekYear}" />
                        </div>
                    </td>
                    <td colspan="3" style="text-align: center; vertical-align: middle; border-right-style: none; border-left-style: none;">
                        <div style="width: 100%">
                            <input type="button" class="btn btn-info" value="Отправить сообщение заказавщим" data-bind="click: SendBooking, visible: ForEmailExistsObject" />
                        </div>
                    </td>
                    <td colspan="2" style="text-align: center; vertical-align: middle; border-right-style: none; border-left-style: none;">
                        <div style="width: 100%">
                            <input type="button" class="btn btn-warning" value="Подтвердить возможность заказа по меню" data-bind="click:SetAsOrderable, visible: !OrderCanBeCreated()" />
                        </div>
                    </td>
                    <td colspan="3" style="text-align: center; vertical-align: middle; border-left-style: none;">
                        <div style="float: right; width: 100%">
                            <input type="button" class="btn " data-bind="click:NextWeekMenuButton.action(), value: NextWeekMenuButton.Message(), css:NextWeekMenuButton.cssclass()" />
                        </div>
                    </td>
                </tr>
                <tr>
                    <th  style="vertical-align: middle; text-align: center">День недели</th>
                    <th colspan="2" style="vertical-align: middle; text-align: center">Категория блюда</th>
                    <th colspan="5" style="vertical-align: middle; text-align: center">Название</th>
                    <th  colspan="2" style="vertical-align: middle; text-align: center">Стоимость</th>
                </tr>
            </thead>
            <tbody data-bind="foreach: MFD_models">
                <tr>
                    <td style="vertical-align: middle; text-align: center">
                        <span data-bind="text: DayOfWeek"></span>
                    </td>
                    <td colspan="2" class="weekmenu" data-bind="foreach: Dishes">
                        <div style="border-bottom: 1px solid; text-align: right" data-bind=" hover: isHovering,  css: { menu_hover : isHovering}, click: function(){$parents[1].showDishes($data, $parentContext.$index())}">
                            <span data-bind="text: $data.Category() + ' : '"></span>
                        </div>
                    </td>
                    <td colspan="5" class="weekmenu" data-bind="foreach: Dishes">
                        <div style="border-bottom: 1px solid" data-bind=" hover: isHovering,  css: { menu_hover : isHovering}, click: function(){$parents[1].showDishes($data, $parentContext.$index())}">
                            <span data-bind="text: Title"></span>
                            <button type="button" class="glyphicon glyphicon-pencil btn-success btn-xs" data-bind=" visible: $parent.Editing, click: function(){$parents[1].showDishes($data, $parentContext.$index())}" style="float: right; max-height: 25px; width: 70px;"></button>

                        </div>
                    </td>
                    <td class="weekmenu" data-bind="foreach: Dishes" style="text-align: right;vertical-align: middle">
                        <div data-bind=" hover: isHovering,  css: { menu_hover : isHovering}, click: function(){$parents[1].showDishes($data, $parentContext.$index())}">
                            <span data-bind="text: Price" style="border-bottom: 1px solid; padding: 5px;"></span><br />
                        </div>
                    </td>
                    <td style="text-align: center; vertical-align: middle; height: 100%">
                        <span data-bind="text: TotalPrice"></span>
                    </td>
                </tr>
            </tbody>
            <tfoot>
            <tr>
                <td colspan="9" style="text-align: right"><span>Итого :</span></td>
                <td style="text-align: center; vertical-align: middle; height: 100%">
                    <span data-bind="text: SummaryPrice"></span>
                </td>
            </tr>
            </tfoot>
        </table>
</div>

<div id="modalbox" class="modal ">
    <div class="modal-dialog">
        <div class="panel panel-default">
            <div class="modal-content">
                <div class="modal-header">
                    <h1>Выберите <span data-bind="text:Category"></span> </h1>
                </div>
                <div class="modal-body">
                    <table class="table table-condensed table-striped table-bordered pre-scrollable" id="pageTable">
                        <thead>
                        <tr>
                            <th>№</th>
                            <th>Название</th>
                            <th>Стоимость</th>
                            <th>Выбрать</th>
                        </tr>
                        </thead>
                        <tbody data-bind="foreach:pagedList">
                        <tr>
                            <td>
                                <span data-bind="text: $parent.pageIndex() * $parent.pageSize() + $index() + 1"></span>
                            </td>
                            <td>
                                <span data-bind="text:Title"></span>
                            </td>
                            <td>
                                <span data-bind="text:Price"></span>
                            </td>
                            <td>
                                <input type="radio" name="dishGroup" data-bind="checked: $parent.SelectedDish, checkedValue : DishId, click: $parent.changeSelected"/>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                    <div class="row">
                        <div class="col-sm-6">
                            <div class="dataTables_paginate paging_simple_numbers">
                                <ul class="pagination">
                                    <li data-bind="css: { disabled: pageIndex() === 0 }" class="paginate_button previous">
                                        <a href="#" class="btn" data-bind="click: previousPage">Previous</a>
                                    </li>
                                    <li data-bind=" foreach: allPages">
                                        <a href="#" class="paginate_button" data-bind="text: $data.pageNumber, click: function() { $parent.moveToPage($data.pageNumber-1)  }, css: { active: $data.pageNumber === ($parent.pageIndex() + 1) }"></a>
                                    </li>
                                    <li class="paginate_button next" data-bind="css: { disabled: pageIndex() === maxPageIndex() }">
                                        <a href="#" data-bind="click: nextPage">Next</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-primary" data-bind="click: applyChanges">Ok</button>
                    <button class="btn btn-default" data-dismiss="modal">Закрыть</button>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="modalMessage" class="modal">

    <div class="modal-dialog">
        <div class="panel panel-default">
            <div class="modal-content">
                <div class="modal-header">
                    <h1 data-bind="text: Title"></h1>
                </div>
                <div class="modal-body">
                    <input  data-bind="textInput: Message"/>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-default" data-dismiss="modal">Закрыть</button>
                </div>
            </div>
        </div>
    </div>
</div>
@Scripts.Render("~/bundles/MenuForWeek")


    <script type="text/javascript">
        (function () {
            $(".pre-scrollable").css("maxHeight", "700px")
            .parents('.banner-caption').css({ "top": "11%" });

            $("#pageTable").height("350px");
            $("#modalbox").offset({ top: 100 });

            $("#modalMessage").offset({ top: 200 });

        })();
    </script>


