@{
    ViewBag.Title = "Index";
}

<div class="row">
    <div class="col-md-9 col-xs-offset-3">
        <div class="col-md-6">
            <div class="input-group date">
                <input type="text" class="form-control" data-provide="datepicker" data-bind="datepicker: myDate" />
            </div>
        </div>
        <div class="col-md-6">
            <nav class="navbar">
                <div class="container-fluid">
                    <ul class="nav navbar-nav navbar-right">
                        <li class="active ">
                            <a href="@Url.RouteUrl(new {action = "WeekMenu", controller = "SU_", area = "SU_Area"})">Меню</a>
                        </li>

                        <li>
                            <a href="@Url.RouteUrl(new {action = "Orders", controller = "SU_", area = "SU_Area"})">Заявки</a>
                        </li>

                        <li>
                            <a href="@Url.RouteUrl(new {action = "Dishes", controller = "SU_", area = "SU_Area"})">Блюда</a>
                        </li>
                        <li>
                            <a href="@Url.RouteUrl(new {action = "Payment", controller = "SU_", area = "SU_Area"})">Оплаты</a>
                        </li>
                    </ul>
                </div>
            </nav>
        </div>
    </div>
</div>
    <div class="panel panel-default" id="mfwPanel">
        <table>
            <tbody>
                <tr style="background: #565659;">
                    <td class="col-md-3">
                        <div>
                            <input type="button" value="Перейти на текущую неделю" id="curweek" class="btn" data-bind=" click: SetMyDateByWeek(CurrentWeekNumber()),css:{disabled: IsCurrentWeek}" />
                        </div>
                    </td>
                    <td class="col-md-5  " style="float: right">
                        <div>
                            <!--ko ifnot: IsNextWeekMenuExist -->
                                <input type="button" id="btnaddmenu" class="btn" value="Создать меню на следующую неделю" data-bind="click:CreateNextWeekMenu"/> 
                            <!--/ko--> 
                            <!--ko if: IsNextWeekMenu-->
                            <input type="button" id="btnDel" class="btn btn-danger" value="Удалить меню на следующую неделю" data-bind="click:DeleteNextWeekMenu" />
                            <!--/ko--> 
                        </div>
                    </td>
                </tr>
            </tbody>
        </table>
        <table class="table table-striped table-bordered table-responsive table-condensed table-hover" id="updateTable" >
            <thead>
                <tr>
                    <th class="col-sm-1">День недели</th>
                    <th class="col-sm-2">Категория блюда</th>
                    <th class="col-sm-5">Название</th>
                    <th class="col-sm-2" colspan="2" style="text-align: center">Стоимость</th>
                    <th class="col-sm-2" style="text-align: center"><span data-bind="text: BeenChanged()?'Сохранить / Отмена':'Изменить' "></span></th>
                </tr>
            </thead>
            <tbody data-bind="foreach: MFD_models">
                <tr>
                    <td style="vertical-align: middle; text-align: center">
                        <span data-bind="text: DayOfWeek"></span>
                    </td>
                    <td data-bind="foreach: Dishes">
                        <div style="border-bottom: 1px solid; text-align: right">
                            <span data-bind="text: $data.Category() + ' : '"></span>
                        </div>
                    </td>
                    <td data-bind="foreach: Dishes">
                        <div style="border-bottom: 1px solid">
                            <span data-bind="text: Title"></span>
                            <button type="button" class="glyphicon glyphicon-pencil btn-success btn-xs" data-bind=" visible: $parent.Editing, click: function(){$parents[1].showDishes($data, $parentContext.$index())}" style="float: right; max-height: 15px; width: 70px;"></button>

                        </div>
                    </td>
                    <td data-bind="foreach: Dishes" style="text-align: right">
                        <div>
                            <span data-bind="text: Price" style="border-bottom: 1px solid"></span><br />
                        </div>
                    </td>
                    <td style="text-align: right; vertical-align: middle; height: 100%">
                        <span data-bind="text: TotalPrice"></span>
                    </td>
                    <td style="vertical-align: middle; text-align: center">
                        <!-- ko ifnot: Editing -->
                        <button class="glyphicon glyphicon-pencil btn-success btn-lg" data-bind="click: function(){ $parent.edit($data)} "></button>
                        <!--/ko--> 
                        <!-- ko if: Editing -->
                        <button class="glyphicon glyphicon-save btn-warning btn-lg" data-bind="click: function(){ $parent.save($data)} "></button>
                        <button class="glyphicon glyphicon-adjust btn-danger btn-lg" data-bind="click: function(){ $parent.cancel($data)} "></button>
                        <!--/ko-->
                    </td>

                </tr>
            </tbody>
            <tfoot>
                <tr>
                    <td style="border-bottom: 1px solid; border-right: 0" colspan="2"></td>
                    <td style="border-bottom: 1px solid; align-content: stretch; border-left: 0" colspan="2">
                        <span style="float: right;"> Итого: </span>
                    </td>
                    <td style="border-bottom: 1px solid; text-align: right" >
                        <span data-bind=" text : SummaryPrice()"></span>
                    </td>
                    <td style="border-bottom: 1px solid;"></td>
                </tr>
                <tr>
                    <td colspan="7">
                        <div class="dataTables_paginate paging_simple_numbers" style="padding:5px;">
                            <ul class="pagination">
                                <li class=" paginate_button previous">
                                    <a href="#" data-bind=" click: function(){ SetMyDateByWeek(WeekNumber() - 1); }">Previous</a>
                                </li>
                                <li class="paginate_button " data-bind="foreach: NumbersWeeks">
                                    <a href="#" class="paginate_button" data-bind="text: $data, css: { active: $data == $parent.WeekNumber()}, click: function(){ $parent.SetMyDateByWeek($data); }"></a>
                                </li>
                                <li class=" paginate_button next">
                                    <a href="#" data-bind="click: function(){ SetMyDateByWeek(WeekNumber() + 1 ); }">Next</a>
                                </li>
                            </ul>
                        </div>
                    </td>
                </tr>
            </tfoot>
        </table>
    </div>

    <div id="modalbox" class="modal ">
    <div class="modal-dialog">
        <div class="panel panel-default">
            <div class="modal-content">
                <div class="modal-header">
                    <h1>Выберите <span data-bind="text:Category"></span> </h1>
                </div>
                <div class="modal-body">
                    <table class="table table-condensed table-striped table-bordered pre-scrollable" id="pageTable">
                        <thead>
                            <tr>
                                <th>№</th>
                                <th>Название</th>
                                <th>Стоимость</th>
                                <th>Выбрать</th>
                            </tr>
                        </thead>
                        <tbody data-bind="foreach:pagedList">
                            <tr>
                                <td>
                                    <span data-bind="text: $parent.pageIndex() * $parent.pageSize() + $index() + 1"></span>
                                </td>
                                <td>
                                    <span data-bind="text:Title"></span>
                                </td>
                                <td>
                                    <span data-bind="text:Price"></span>
                                </td>
                                <td>
                                    <input type="radio" name="dishGroup" data-bind="checked: $parent.SelectedDish,checkedValue : DishId, click: $parent.changeSelected" />
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <div class="row">
                        <div class="col-sm-6">
                            <div class="dataTables_paginate paging_simple_numbers">
                                <ul class="pagination">
                                    <li data-bind="css: { disabled: pageIndex() === 0 }" class="paginate_button previous">
                                        <a href="#" class="btn" data-bind="click: previousPage">Previous</a>
                                    </li>
                                    <li data-bind=" foreach: allPages">
                                        <a href="#" class="paginate_button" data-bind="text: $data.pageNumber, click: function() { $parent.moveToPage($data.pageNumber-1)  }, css: { active: $data.pageNumber === ($parent.pageIndex() + 1) }"></a>
                                    </li>
                                    <li class="paginate_button next" data-bind="css: { disabled: pageIndex() === maxPageIndex() }">
                                        <a href="#" data-bind="click: nextPage">Next</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-primary" data-bind="click: applyChanges">Ok</button>
                    <button class="btn btn-default" data-dismiss="modal">Закрыть</button>
                </div>
            </div>
        </div>
    </div>
</div>
@Scripts.Render("~/bundles/MenuForWeek")


    <script type="text/javascript">
        (function () {
            $(".pre-scrollable").css("maxHeight", "700px")
            .parents('.banner-caption').css({ "top": "11%" });

            $("#pageTable").height("350px");
            $("#modalbox").offset({ top: 100 });

        })();
    </script>


